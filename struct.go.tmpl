{{- define "struct" -}}
{{- $struct := .Struct -}}
{{- $type := .TypeDict -}}

type {{$struct.Name}} struct {
{{- range $_, $field := $struct.Fields -}}
	{{- $fieldName := $field.Name | pascalCase -}}
	{{- $jsonName := $field.Name | camelCase }}
	{{- $dbName := "" }}
	{{- range $meta := $field.Meta -}}
		{{- if exists $meta "go.field.name" -}}
			{{- $fieldName = get $meta "go.field.name" -}}
		{{- end -}}
		{{- if exists $meta "json" -}}
			{{- $jsonName = get $meta "json" -}}
		{{- end -}}
		{{- if exists $meta "go.tag.json" -}}
			{{- $jsonName = get $meta "go.tag.json" -}}
		{{- end -}}
		{{- if exists $meta "go.tag.db" -}}
			{{- $dbName = get $meta "go.tag.db" -}}
		{{- end -}}
	{{- end -}}
	{{- $jsonTags := printf "json:%q" $jsonName -}}
	{{- $dbTags := "" -}}
	{{if $dbName}}
		{{- $dbTags = printf " db:%q" $dbName -}}
	{{- end}}
	{{$fieldName}} {{if and $field.Optional (isBaseType $field.Type)}}*{{end}}{{template "type" dict "Type" $field.Type "TypeDict" $type}} `{{$jsonTags}}{{$dbTags}}`
{{- end}}
}
{{- end }}
